(()=>{"use strict";const e=window.wp.blocks,t=window.wp.i18n,n=JSON.parse('{"u2":"wpseopress/faq-block-v2"}'),r=window.wp.blockEditor,o=window.wp.data,c=window.wp.element,s=window.wp.url,a=window.wp.components;function i(e){var n=e.attributes,o=e.setAttributes,c=n.printSchema;return React.createElement(r.InspectorControls,null,React.createElement(a.PanelBody,{title:(0,t.__)("FAQ Settings","wp-seopress")},React.createElement(a.PanelRow,{className:"wpseopress-faqs-seo-settings"},React.createElement(a.ToggleControl,{label:(0,t.__)("Enable FAQ schema","wp-seopress"),checked:!!c,onChange:function(e){o({printSchema:!c})}}))))}var l=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,n){var r;return t.push(null!==(r=(0,e.getBlockContent)(n))&&void 0!==r?r:""),t}),[]).filter((function(e){return"<p></p>"!==e}))};(0,e.registerBlockType)(n.u2,{title:(0,t.__)("FAQ","wp-seopress"),description:(0,t.__)("Allows to easily build FAQs.","wp-seopress"),keywords:[(0,t.__)("FAQ","wp-seopress")],edit:function(e){var t=e.attributes,n=e.setAttributes,a=e.clientId,u=(0,o.select)("core/editor").getPermalink(),p=(0,o.useSelect)((function(e){var t;return(null===(t=e("core/block-editor").getBlock(a))||void 0===t?void 0:t.innerBlocks)||[]}),[p]),d=(0,o.dispatch)("core/block-editor").updateBlockAttributes,w=p.map((function(e){var t;if("core/details"!==e.name)return{};var n=(null===(t=e.attributes)||void 0===t||null===(t=t.summary)||void 0===t?void 0:t.text)||"",r=(0,s.cleanForSlug)(n);return{"@type":"Question",url:"".concat(u,"#").concat(r),name:n,acceptedAnswer:{"@type":"Answer",answerCount:1,text:l((null==e?void 0:e.innerBlocks)||[]).join("")}}})),m={"@context":"https://schema.org","@type":"FAQPage",url:u,"@id":u,mainEntity:w||[]};return(0,c.useEffect)((function(){JSON.stringify(t.schema)!==JSON.stringify(m)&&n({schema:m}),p.forEach((function(e){var t,n=(null===(t=e.attributes)||void 0===t||null===(t=t.summary)||void 0===t?void 0:t.text)||"",r=(0,s.cleanForSlug)(n);r!==e.attributes.anchor&&d(e.clientId,{anchor:r})}))}),[p]),React.createElement(React.Fragment,null,React.createElement(i,{attributes:t,setAttributes:n}),React.createElement("div",(0,r.useBlockProps)(),React.createElement(r.InnerBlocks,null)))},save:function(e){var t=e.attributes,n=JSON.stringify((null==t?void 0:t.schema)||"");return React.createElement("div",r.useBlockProps.save(),React.createElement(r.InnerBlocks.Content,null),t.printSchema&&n&&React.createElement("script",{type:"application/ld+json"},n))}})})();